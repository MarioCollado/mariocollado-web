---
// src/components/Film.astro
import content from "../json/content.json"; // Importar el JSON
---

<section
  id="film"
  class="h-screen flex flex-col justify-start items-center bg-primary-light text-gray-800 relative overflow-hidden snap-start"
>
  <!-- Flecha para volver a la sección anterior -->
  <a
    href="#home"
    class="absolute top-8 left-1/2 transform -translate-x-1/2 cursor-pointer opacity-0 hover:opacity-100 transition-opacity duration-300"
  >
    <img
      src="/arrow-bottom.svg"
      alt="Flecha arriba"
      class="w-10 h-10 rotate-180"
    />
  </a>

  <!-- Contenedor de imágenes y videos en mosaico -->
  <div
    id="mosaic-container"
    class="grid grid-cols-3 gap-4 p-32 w-full h-full overflow-y-auto"
    style="grid-auto-rows: minmax(200px, auto);"
    data-content={JSON.stringify(content)}
  >
    {
      content.map((item, index) => (
        <div
          class={`${
            item.tipo === "video" ? "relative" : ""
          } border-4 border-black shadow-[8px_8px_0_0_black] cursor-pointer`}
          onclick={`openModal(${index})`}
        >
          {item.tipo === "foto" ? (
            <img
              src={item.ruta}
              alt={item.descripcion}
              class="w-full h-full object-cover"
            />
          ) : (
            <video class="w-full h-full object-cover">
              <source src={item.ruta} type="video/webm" />
              <source
                src={item.ruta.replace(".webm", ".mp4")}
                type="video/mp4"
              />
              Tu navegador no soporta la reproducción de videos.
            </video>
          )}
        </div>
      ))
    }
  </div>

  <!-- Flecha para ir a la siguiente sección -->
  <a
    href="#music"
    class="absolute bottom-8 left-1/2 transform -translate-x-1/2 cursor-pointer opacity-0 hover:opacity-100 transition-opacity duration-300"
  >
    <img src="/arrow-bottom.svg" alt="Flecha abajo" class="w-10 h-10" />
  </a>

  <!-- Modal -->
  <div
    id="modal"
    class="fixed inset-0 bg-secondary-gray flex justify-center items-center opacity-0 pointer-events-none transition-opacity duration-300 z-50"
    onclick="closeModal()"
  >
    <div class="relative max-w-full max-h-full p-4">
      <img
        id="modal-image"
        class="max-w-full max-h-[80vh] object-contain"
        alt="Imagen en modal"
      />
      <video
        id="modal-video"
        class="max-w-full max-h-[80vh] object-contain hidden"
        controls
      >
        <source id="modal-video-source" type="video/webm" />
        Tu navegador no soporta la reproducción de videos.
      </video>
    </div>
  </div>

  <!-- Importar el archivo JS -->
  <script type="module" src="src/js/filmZoom.js"></script>
</section>
